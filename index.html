<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inbondz Search - Fully Free Knowledge Engine</title>
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Load React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Load Babel for JSX and modern JS support -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* General styling for a professional look */
        body { font-family: 'Inter', sans-serif; }
        .knowledge-background {
            min-height: 100vh;
            background-color: #f9fafb;
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body>
    <div id="root">
        <!-- React App will render here -->
    </div>

    <!-- The type="text/babel" tells the browser to process this script with Babel -->
    <script type="text/babel">
        // Import necessary icons from Lucide (mimicking the React import)
        const { Search, Loader, Info, Home, FileText, Phone, ArrowLeft, ExternalLink } = lucide;
        const { useState, useCallback, useEffect } = React;

        // --- Global Constants ---
        const WIKIPEDIA_API_URL = 'https://en.wikipedia.org/w/api.php';
        const APP_NAME = 'Inbondz Search';

        // --- Utility Functions ---

        /**
         * Custom fetch function for the free Wikipedia API.
         * Uses the 'search' list query to get relevant articles, definitions, and info.
         */
        const fetchWikipedia = async (query) => {
            const params = {
                action: 'query',
                list: 'search',
                srsearch: query,
                format: 'json',
                origin: '*', // Required for CORS
                srlimit: 15, // Retrieve more results for a better experience
                srsort: 'relevance',
            };
            
            const url = WIKIPEDIA_API_URL + '?' + new URLSearchParams(params).toString();
            
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`API returned status: ${response.status}`);
                }
                
                const data = await response.json();
                return data.query.search || [];
            } catch (e) {
                console.error("Wikipedia API Fetch Error:", e);
                throw new Error("Failed to fetch results from the knowledge base.");
            }
        };

        // --- Component: Search Result Card ---
        const SearchResultCard = ({ result }) => {
            const pageTitle = result.title;
            
            // Clean up snippet HTML tags and entities for a cleaner display
            let snippet = result.snippet.replace(/<span[^>]*>/g, '').replace(/<\/span>/g, '');
            // Use DOMParser to decode HTML entities (like &quot;) cleanly
            try {
                snippet = new DOMParser().parseFromString(snippet, 'text/html').documentElement.textContent;
            } catch (e) {
                // Fallback for simple content
            }


            const pageId = result.pageid;
            const pageUrl = `https://en.wikipedia.org/?curid=${pageId}`;

            return (
                <div className="p-4 bg-white rounded-xl shadow-md hover:shadow-lg transition duration-300 border-l-4 border-blue-500 flex flex-col">
                    <a href={pageUrl} target="_blank" rel="noopener noreferrer" className="flex items-center justify-between">
                        <h2 className="text-xl font-medium text-blue-700 hover:text-blue-900 leading-tight">
                            {pageTitle}
                        </h2>
                        <ExternalLink size={18} className="text-gray-400 hover:text-blue-600 transition flex-shrink-0 ml-2" />
                    </a>
                    
                    <p 
                        className="text-gray-700 mt-2 text-sm line-clamp-3 mb-2" 
                    >
                        {snippet}
                    </p>
                    <div className="mt-auto pt-2 text-xs text-green-600 truncate">
                        <span className="font-mono">{pageUrl}</span>
                    </div>
                </div>
            );
        };

        // --- Main App Component ---
        const App = () => {
            const [query, setQuery] = useState('');
            const [results, setResults] = useState([]);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);
            const [view, setView] = useState('home'); // 'home' | 'results' | 'policy' | 'terms' | 'contact'

            // Load initial state from local storage and run search if query exists
            useEffect(() => {
                const savedQuery = localStorage.getItem(APP_NAME + '_query');
                if (savedQuery) {
                    setQuery(savedQuery);
                    handleSearch(savedQuery, true); // Rerun search on load if query exists
                    setView('results');
                }
            }, []);

            // Function to handle the search logic
            const handleSearch = useCallback(async (searchQuery, isInitialLoad = false) => {
                const trimmedQuery = searchQuery.trim();
                if (!trimmedQuery) {
                    setResults([]);
                    setError(null);
                    setView('home');
                    return;
                }

                setIsLoading(true);
                setError(null);
                localStorage.setItem(APP_NAME + '_query', trimmedQuery);
                if (!isInitialLoad) {
                    setView('results');
                }

                try {
                    const data = await fetchWikipedia(trimmedQuery);
                    setResults(data);
                } catch (err) {
                    console.error("Search failed:", err);
                    setError(err.message || "An unknown error occurred during search.");
                    setResults([]);
                } finally {
                    setIsLoading(false);
                }
            }, []);

            // Handle form submission
            const handleSubmit = (e) => {
                e.preventDefault();
                handleSearch(query);
            };

            // --- Content Rendering based on View State ---

            const renderMainContent = () => {
                if (view === 'home') {
                    return (
                        <div className="flex flex-col items-center justify-center min-h-[50vh]">
                            <h1 className="text-6xl font-black text-gray-900 mb-6 tracking-tight">
                                <span className="text-blue-600">inbondz</span> search
                            </h1>
                            <p className="text-xl text-gray-500 mb-10 max-w-lg text-center">
                                Find definitions, facts, and encyclopedia knowledge instantly.
                            </p>
                        </div>
                    );
                }

                if (view === 'results') {
                    if (isLoading) {
                        return (
                            <div className="py-20 flex flex-col items-center justify-center text-blue-600">
                                <Loader size={48} className="animate-spin mb-4" />
                                <p className="text-lg">Searching the knowledge base...</p>
                            </div>
                        );
                    }

                    if (error) {
                        return (
                            <div className="p-6 bg-red-100 border-l-4 border-red-500 text-red-700 rounded-lg flex items-start">
                                <Info className="w-6 h-6 mr-4 flex-shrink-0" />
                                <div>
                                    <h3 className="font-semibold text-lg mb-1">Search Error</h3>
                                    <p>{error}</p>
                                    <p className="mt-2 text-sm opacity-80">This usually means an issue with the external Wikipedia API or your connection.</p>
                                </div>
                            </div>
                        );
                    }

                    if (results.length === 0) {
                        return (
                            <div className="p-10 text-center bg-gray-100 rounded-xl text-gray-600">
                                <Info size={32} className="mx-auto mb-3 text-gray-400" />
                                <p className="text-lg font-medium">No results found for **"{query}"**.</p>
                                <p className="text-sm mt-1">Try a more general search term.</p>
                            </div>
                        );
                    }

                    return (
                        <div className="space-y-6">
                            <p className="text-sm text-gray-500 font-medium">
                                Showing {results.length} results for **"{query}"**
                            </p>
                            <div className="grid md:grid-cols-2 gap-4">
                                {results.map((result) => (
                                    <SearchResultCard key={result.pageid} result={result} />
                                ))}
                            </div>
                        </div>
                    );
                }
                
                // --- Static Pages ---
                
                const staticPageContent = {
                    policy: { title: "Privacy Policy", content: "We do not track or store any personal data. All searches are conducted anonymously via the free Wikipedia API and are not logged by this site. Your search query is temporarily saved in your browser's local storage to persist your last search, which you can clear at any time." },
                    terms: { title: "Terms of Service", content: "This service is provided 'as is' and relies on the content provided by the Wikipedia API, which is subject to the Creative Commons Attribution-ShareAlike 3.0 Unported License (CC BY-SA). We claim no ownership over the search results. By using this site, you agree not to use the service for any illegal or harmful purposes." },
                    contact: { title: "Contact Information", content: (
                        <>
                            <p className="mb-3">For all general inquiries and grievance handling, please contact us at:</p>
                            <a href="mailto:grievance@inbondz.com" className="text-blue-600 hover:text-blue-800 font-semibold flex items-center">
                                <Phone size={18} className="mr-2"/> grievance@inbondz.com
                            </a>
                        </>
                    ) },
                };

                const page = staticPageContent[view];
                if (page) {
                    return (
                        <div className="bg-white p-8 md:p-12 rounded-xl shadow-lg border-t-4 border-blue-500">
                            <div className="flex items-center mb-6">
                                <button onClick={() => setView('home')} className="p-2 mr-4 rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 transition">
                                    <ArrowLeft size={20} />
                                </button>
                                <h2 className="text-3xl font-bold text-gray-800">{page.title}</h2>
                            </div>
                            <div className="text-gray-700 leading-relaxed space-y-4">
                                {typeof page.content === 'string' ? <p>{page.content}</p> : page.content}
                            </div>
                        </div>
                    );
                }

                return null;
            };
            
            // Determine if the search bar should be centered (home view) or sticky (results view)
            const isHomeView = view === 'home';
            const searchWrapperClass = isHomeView 
                ? "w-full max-w-2xl transition-all duration-500"
                : "w-full max-w-2xl fixed top-0 left-1/2 -translate-x-1/2 transform -translate-x-1/2 z-50 bg-white pt-4 pb-4 shadow-xl transition-all duration-500 md:shadow-lg";

            return (
                <div className="knowledge-background">
                    
                    {/* Header / Search Bar */}
                    <div className={`p-4 ${isHomeView ? 'pt-24' : 'pt-4 md:pt-6'} flex justify-center`}>
                        <form onSubmit={handleSubmit} className={searchWrapperClass}>
                            <div className="flex items-center bg-white border-2 border-blue-500 rounded-full shadow-2xl hover:shadow-blue-300/50">
                                <input
                                    type="text"
                                    value={query}
                                    onChange={(e) => setQuery(e.target.value)}
                                    placeholder={isHomeView ? "Search the knowledge base..." : query || "Search..."}
                                    className="flex-grow p-3 pl-6 text-lg rounded-l-full focus:outline-none"
                                />
                                
                                <button
                                    type="submit"
                                    disabled={isLoading}
                                    className="p-3 bg-blue-600 text-white rounded-r-full hover:bg-blue-700 transition disabled:bg-blue-400 flex items-center justify-center"
                                >
                                    {isLoading ? <Loader size={24} className="animate-spin" /> : <Search size={24} />}
                                </button>
                            </div>
                        </form>
                    </div>


                    {/* Main Content Area */}
                    <main className={`flex-grow p-4 md:p-8 flex justify-center ${!isHomeView ? 'mt-16 md:mt-24' : ''}`}>
                        <div className="w-full max-w-4xl">
                            {renderMainContent()}
                        </div>
                    </main>
                    
                    {/* Footer */}
                    <footer className="bg-gray-900 text-white p-6 md:p-8 mt-auto">
                        <div className="max-w-4xl mx-auto flex flex-col md:flex-row justify-between items-center md:items-start space-y-4 md:space-y-0">
                            
                            <div className="text-center md:text-left">
                                <h3 className="text-xl font-bold mb-1">
                                    <span className="text-blue-400">inbondz</span> search
                                </h3>
                                <p className="text-xs text-gray-400">
                                    Knowledge powered by the free MediaWiki API.
                                </p>
                            </div>

                            <nav className="flex flex-wrap justify-center md:justify-end space-x-6 text-sm">
                                <button onClick={() => setView('home')} className="flex items-center hover:text-blue-400 transition">
                                    <Home size={16} className="mr-1"/> Home
                                </button>
                                <button onClick={() => setView('policy')} className="flex items-center hover:text-blue-400 transition">
                                    <FileText size={16} className="mr-1"/> Privacy Policy
                                </button>
                                <button onClick={() => setView('terms')} className="flex items-center hover:text-blue-400 transition">
                                    <FileText size={16} className="mr-1"/> Terms of Service
                                </button>
                                <button onClick={() => setView('contact')} className="flex items-center hover:text-blue-400 transition">
                                    <Phone size={16} className="mr-1"/> Contact
                                </button>
                            </nav>
                        </div>
                        <div className="mt-4 pt-4 border-t border-gray-700 text-center text-xs text-gray-500">
                            &copy; 2024 Inbondz Search. All rights reserved.
                        </div>
                    </footer>
                </div>
            );
        };

        // Render the application to the 'root' div
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);

    </script>
</body>
</html>















